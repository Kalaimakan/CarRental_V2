@{
    Layout = "~/Views/Shared/_AdminLayout.cshtml";
}

@model List<CarRental.DTOs.CarDto>

@if (TempData["Success"] != null)
{
    <div class="alert alert-success alert-dismissible fade show m-3 professional-alert" role="alert">
        <i class="bi bi-check-circle me-2"></i>@TempData["Success"]
        <button type="button" class="btn-close btn-close-white" data-bs-dismiss="alert" aria-label="Close"></button>
    </div>
}

<div class="container-fluid mt-4">
    <div class="card dashboard-card shadow-lg border-0">

        <!-- Dashboard Title -->
        <div class="card-header text-white text-center py-3 dashboard-header">
            <h3 class="mb-0 fw-bold">Car List Dashboard</h3>
        </div>

        <!-- Top Actions -->
        <div class="d-flex flex-wrap justify-content-between align-items-center px-3 py-3 actions-bar">

            <!-- Search Bar -->
            <form asp-action="SearchCar" method="get" class="row g-2 g-md-3 align-items-center flex-grow-1 me-2">
                <div class="col-md-4">
                    <input type="text" name="brand" class="form-control custom-search" placeholder="Search by Brand" value="@Context.Request.Query["brand"]" />
                </div>
                <div class="col-md-4">
                    <input type="text" name="model" class="form-control custom-search" placeholder="Search by Model" value="@Context.Request.Query["model"]" />
                </div>
                <div class="col-md-2 d-grid">
                    <button type="submit" class="btn btn-info fw-bold">Search</button>
                </div>
            </form>

            <!-- Add Car Button -->
            <a class="btn btn-primary fw-bold shadow-sm" asp-action="Add">
                <i class="bi bi-plus-circle me-1"></i> Add Car
            </a>
        </div>

        <!-- Table -->
        <div class="table-responsive p-3">
            <table class="table table-hover align-middle text-center text-white mb-0 professional-table">
                <thead class="table-header">
                    <tr>
                        <th>Brand</th>
                        <th>Model</th>
                        <th>Colour</th>
                        <th>Seats</th>
                        <th>Fuel</th>
                        <th>Transmission</th>
                        <th>AC</th>
                        <th>Price/Day</th>
                        <th>Status</th>
                        <th>Images</th>
                        <th>Action</th>
                    </tr>
                </thead>
                <tbody>
                    @if (Model != null && Model.Any())
                    {
                        @foreach (var car in Model)
                        {
                            <tr>
                                <td>@car.CarBrand</td>
                                <td>@car.CarModel</td>
                                <td>@car.CarColour</td>
                                <td>@car.Seats</td>
                                <td>@car.FuelType</td>
                                <td>@car.Transmission</td>
                                <td>@(car.HasAC ? "AC" : "Non-AC")</td>
                                <td>Rs. @car.PricePerDay</td>
                                <td>
                                    @if (car.Status)
                                    {
                                        <span class="badge badge-available">Available</span>
                                    }
                                    else
                                    {
                                        <span class="badge badge-unavailable">Not Available</span>
                                    }
                                </td>
                                <td>
                                    <div class="d-flex justify-content-center gap-2">
                                        @foreach (var img in car.Images.Take(2))
                                        {
                                            <img src="~/images/@img.FileName"
                                                 class="rounded shadow-sm img-preview" />
                                        }
                                    </div>
                                </td>
                                <td>
                                    <div class="d-flex justify-content-center gap-1">
                                        <a class="btn btn-outline-info btn-sm" asp-action="Update" asp-route-id="@car.Id">
                                            <i class="bi bi-pencil-square"></i>
                                        </a>
                                        <a class="btn btn-outline-danger btn-sm" asp-action="Delete" asp-route-id="@car.Id"
                                           onclick="return confirm('Are you sure you want to delete this car?');">
                                            <i class="bi bi-trash"></i>
                                        </a>
                                    </div>
                                </td>
                            </tr>
                        }
                    }
                    else
                    {
                        <tr>
                            <td colspan="11" class="text-center text-muted py-4">No cars found.</td>
                        </tr>
                    }
                </tbody>
            </table>
        </div>
    </div>
</div>

<style>
    /* General Background */
    body {
        background-color: #0b0f1a;
        font-family: 'Segoe UI', sans-serif;
    }

    /* Professional Alert */
    .professional-alert {
        backdrop-filter: blur(6px);
        background-color: rgba(0, 128, 255, 0.2);
        border: 1px solid rgba(0,128,255,0.5);
        color: #fff;
    }

    /* Card */
    .dashboard-card {
        border-radius: 1rem;
        background-color: rgba(10,25,47,0.95);
        backdrop-filter: blur(14px);
        color: #f1f5f9;
        transition: transform 0.3s ease, box-shadow 0.3s ease;
    }

        .dashboard-card:hover {
            transform: translateY(-3px);
            box-shadow: 0 12px 25px rgba(0,0,0,0.7);
        }

    /* Card Header */
    .dashboard-header {
        background: linear-gradient(90deg, #0d1b2a, #1b263b);
        border-bottom: 1px solid rgba(0,128,255,0.4);
        border-radius: 1rem 1rem 0 0;
    }

    /* Top Actions Bar */
    .actions-bar {
        background-color: rgba(0,0,0,0.3);
        border-bottom: 1px solid rgba(255,255,255,0.1);
        border-radius: 0 0 0.5rem 0.5rem;
    }

    /* Table */
    .professional-table thead.table-header {
        background-color: rgba(0,128,255,0.2);
        color: #fff;
        font-weight: 600;
    }

    .professional-table tbody tr {
        background-color: rgba(255,255,255,0.05);
        transition: all 0.2s ease-in-out;
    }

        .professional-table tbody tr:hover {
            background-color: rgba(0, 128, 255, 0.15);
            transform: scale(1.01);
        }

    /* Action Buttons */
    .btn-outline-info:hover {
        background-color: rgba(0, 123, 255, 0.8);
        color: #fff;
    }

    .btn-outline-danger:hover {
        background-color: rgba(255, 0, 0, 0.7);
        color: #fff;
    }

    /* Badges */
    .badge-available {
        background: linear-gradient(135deg, #00ff7f, #00c853);
        color: #fff;
        font-weight: 500;
        padding: 0.35em 0.6em;
        border-radius: 6px;
    }

    .badge-unavailable {
        background: linear-gradient(135deg, #ff416c, #ff4b2b);
        color: #fff;
        font-weight: 500;
        padding: 0.35em 0.6em;
        border-radius: 6px;
    }

    /* Images Preview */
    .img-preview {
        width: 60px;
        height: 40px;
        object-fit: cover;
        border-radius: 6px;
        border: 1px solid rgba(255,255,255,0.2);
    }

    /* Search Input */
    .custom-search {
        background-color: rgba(255,255,255,0.1);
        color: #fff;
        border: 1px solid rgba(255,255,255,0.2);
        border-radius: 6px;
    }

        .custom-search:focus {
            background-color: rgba(255,255,255,0.15);
            color: #fff;
            border-color: rgba(0,128,255,0.7);
            box-shadow: 0 0 6px rgba(0,128,255,0.5);
            outline: none;
        }

    /* Scrollbar */
    .table-responsive::-webkit-scrollbar {
        height: 6px;
    }

    .table-responsive::-webkit-scrollbar-thumb {
        background: rgba(0,128,255,0.5);
        border-radius: 10px;
    }

    .table-responsive::-webkit-scrollbar-track {
        background: rgba(255,255,255,0.05);
        border-radius: 10px;
    }
</style>
